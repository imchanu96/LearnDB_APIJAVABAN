desc emp;

CREATE TABLE date_test_emp
as
SELECT EMPNO, ENAME, HIREDATE
FROM EMP;

SELECT *
FROM EMP;

SELECT *
FROM DATE_TEST_EMP;

INSERT INTO DATE_TEST_EMP
VALUES(1, '자바', '20230601');

SELECT EMPNO, ENAME, HIREDATE, TO_CHAR(HIREDATE, 'YYYYMMDD HH24:MI:SS')
FROM DATE_TEST_EMP
ORDER BY HIREDATE DESC;

INSERT INTO DATE_TEST_EMP
VALUES(1, '자바', '20230601 14:19:30');

--형식을 맞춰서 넣어줘야된다. 그게 FORMAT의 기본이다.
INSERT INTO DATE_TEST_EMP
VALUES(1, '자바', TO_DATE('20230603 07:10:30', 'YYYYMMDD HH24:MI:SS'));

ROLLBACK;

-- 시간은 금이다
1시간?
SELECT 1 * 60 * 60 "시간은 몇초일까?"
FROM DUAL;

--1년을 기준으로 
--일       시       분       초

SELECT CONCAT('1년은 ', 1 * 365) ||'일' 일
, CONCAT('1년은 ', 1 * 365 * 24)||'시간' 시
, CONCAT('1년은 ', 1 * 365 * 24 * 60) || '분' 분
, CONCAT('1년은 ', 1 * 365 * 24 * 60 * 60) || '초' 초
FROM DUAL;

SELECT (8760 + 525600) / 60 / 60 || '초' 
FROM DUAL;

--미국      달러를
--한국      원화로
--20230601 기준 1달러는 1321.62원

--한국 원화를 미국 달러로 변환해주는 SQL문

SELECT CONCAT(100, '달러') 미국화폐, CONCAT(100 * 1322.8350, '원') 한국화폐
FROM DUAL;

SELECT CONCAT(10000, '원') 한국화폐, CONCAT ( TRUNC(10000 / 1321.62, 2), '달러') 미국화폐
FROM DUAL;

--여러분이 여행 가고 싶은 나라?
-- 콩고 화폐 프랑 1프랑은 2.15원

SELECT CONCAT(100, '프랑') 콩고화폐, CONCAT(100 * 2.1544, '원') 한국화폐
FROM DUAL;

SELECT CONCAT(10000, '원') 한국화폐, CONCAT (TRUNC(10000 / 2.1544, 2), '프랑') 콩고화폐
FROM DUAL;

--TO_CHAR()?

SELECT SYSDATE, SYSDATE - 365, TO_CHAR(SYSDATE - 365, 'YYYYMMDD HH24:MI:SS')
, SYSDATE - (9/24), TO_CHAR(SYSDATE - (9/24), 'YYYYMMDD HH24:MI:SS')
FROM DUAL;

SELECT ENAME, SYSDATE - HIREDATE, HIREDATE
FROM EMP;

DESC DATE_TEST_EMP;

--INSERT INTO DATE_TEST_EMP
--VALUES (1111, '임찬우', TO_DATE('20110601 08:48:32', 'YYYYMMDD HH24:MI:SS'));
--
--INSERT INTO DATE_TEST_EMP
--VALUES (2222, 'IMCHANU', TO_DATE('20110601 16:48:32', 'YYYYMMDD HH24:MI:SS'));
--
--SELECT EMPNO, ENAME, HIREDATE, TO_CHAR(HIREDATE, 'YYYYMMDD HH24:MI:SS')
--FROM DATE_TEST_EMP;
--
--SELECT SYSDATE - HIREDATE
--FROM DATE_TEST_EMP;
--
--SELECT (SYSDATE - HIREDATE) / 365
--FROM DATE_TEST_EMP;
--
--SELECT EMPNO 사원번호, ENAME 사원이름
--, TO_CHAR(HIREDATE, 'YYYYMMDD HH24:MI:SS') 입사일자, CEIL((SYSDATE - HIREDATE) / 365) 경력
--FROM DATE_TEST_EMP;
--
--SELECT EMPNO 사원번호, ENAME 사원이름
--, TO_CHAR(HIREDATE, 'YYYYMMDD HH24:MI:SS') 입사일자
--, (SYSDATE - HIREDATE) * 31536000
--AS 경력
--FROM DATE_TEST_EMP;
--
--SELECT EMPNO 사원번호, ENAME 사원이름
--, TO_CHAR(HIREDATE, 'YYYYMMDD HH24:MI:SS') 입사일자
--, TO_DATE('2011/05/31 10:00:00', 'YYYY/MM/DD HH24:MI:SS') AS "특정 일자"
--, TRUNC((TO_DATE('2011/05/31 10:00:00', 'YYYY/MM/DD HH24:MI:SS') - HIREDATE) / 365 , 2) 년
--, TRUNC((TO_DATE('2011/05/31 10:00:00', 'YYYY/MM/DD HH24:MI:SS') - HIREDATE) / 365 / 12 * 2, 2) 달
--, TRUNC((TO_DATE('2011/05/31 10:00:00', 'YYYY/MM/DD HH24:MI:SS') - HIREDATE) / 365 / 12 * 2 / 30, 2) 일
--FROM DATE_TEST_EMP;
--
--
--
--
--SELECT EMPNO 사원번호, ENAME 사원이름
--, TO_CHAR(HIREDATE, 'YYYYMMDD HH24:MI:SS') 입사일자
--, (TO_CHAR((SYSDATE - HIREDATE), 'YYYYMMDD HH24:MI:SS') / TO_DATE(365, 'DD')) 경력
--FROM DATE_TEST_EMP;

--20001101 07:00:00    -  20001101 06:00:00
--20001101 07:00:00    -  20001101 08:00:00

DESC DATE_TEST_EMP;

SELECT *
FROM DATE_TEST_EMP;

ROLLBACK;

INSERT INTO DATE_TEST_EMP
VALUE(EMPNO, ENAME, HIREDATE)
VALUES(100, 'AAA', '20001101 07:00:00');

INSERT INTO DATE_TEST_EMP
VALUE(EMPNO, ENAME, HIREDATE)
VALUES(100, 'AAA', TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS'));

SELECT TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 입사날짜
FROM DUAL;


SELECT TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 입사날짜,
    TO_DATE('20011101 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 지난일수
FROM DUAL;


SELECT TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 입사날짜,
    TO_DATE('20011101 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 지난일수,
     TO_DATE('20011101 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') / 365 AS 년
FROM DUAL; -- 실패


SELECT TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 입사날짜,
    TO_DATE('20011101 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 지난일수,
     TO_NUMBER(TO_DATE('20011101 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS')) / 365 AS 년
FROM DUAL;

--넘버(사이에 자동 형변환이 되었다.)날짜 / 넘버
SELECT TO_NUMBER((TO_DATE('20011101 07:00:00', 'YYYYMMDD HH24:MI:SS'))
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS')) / 365 AS 년,
FROM DUAL;


SELECT TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 입사날짜,
    TO_DATE('20011101 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 지난일수,
     TO_NUMBER(TO_DATE('20010501 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS')) / 365 AS 년
FROM DUAL;


SELECT TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 입사날짜,
    TO_DATE('20011101 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS') 지난일수,
     CEIL(TO_NUMBER(TO_DATE('20010501 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - TO_DATE('20001101 07:00:00', 'YYYYMMDD HH24:MI:SS')) / 365) AS 년
FROM DUAL;


SELECT EMPNO, ENAME, HIREDATE,
 CEIL(TO_NUMBER(TO_DATE('19820124 07:00:00', 'YYYYMMDD HH24:MI:SS')
    - HIREDATE) / 365) AS 년
FROM DATE_TEST_EMP
ORDER BY HIREDATE DESC;


SELECT TO_CHAR(TO_DATE('20001101 080000', 'YYYYMMDD HH24MISS'), 'YYYYMMDD HH24:MI:SS') 첫날짜,
    TO_NUMBER(TO_DATE('20001101 080000', 'YYYYMMDD HH24MISS') 
    - TO_DATE('20001001 080000', 'YYYYMMDD HH24MISS')) 두날짜빼기일,
    TO_NUMBER(TO_DATE('20001101 080000', 'YYYYMMDD HH24MISS') 
    - TO_DATE('20001001 080000', 'YYYYMMDD HH24MISS')) * 60 * 24 분,
    TO_NUMBER(TO_DATE('20001101 080000', 'YYYYMMDD HH24MISS') 
    - TO_DATE('20001001 080000', 'YYYYMMDD HH24MISS')) / 365 년차,
    TO_NUMBER(TO_DATE('20001101 080000', 'YYYYMMDD HH24MISS') 
    - TO_DATE('20001001 080000', 'YYYYMMDD HH24MISS')) * 60 * 24   
FROM DUAL;